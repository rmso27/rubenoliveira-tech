{"version":3,"sources":["../../src/test/testCommand.ts"],"sourcesContent":["import {fileURLToPath} from 'node:url'\n\nimport {Command, Config} from '@oclif/core'\n\nimport {type CaptureOptions, captureOutput, type CaptureResult} from './captureOutput.js'\nimport {mockSanityCommand, type MockSanityCommandOptions} from './mockSanityCommand.js'\n\ntype CommandClass = (new (argv: string[], config: Config) => Command) & typeof Command\n\nexport interface TestCommandOptions {\n  /**\n   * Options for capturing output\n   */\n  capture?: CaptureOptions\n  /**\n   * Partial oclif config overrides\n   */\n  config?: Partial<Config>\n  /**\n   * Mock options for SanityCommand dependencies (config, project root, API clients).\n   * When provided, the command is automatically wrapped with mockSanityCommand.\n   */\n  mocks?: MockSanityCommandOptions\n}\n\nexport async function testCommand(\n  command: CommandClass,\n  args?: string[],\n  options?: TestCommandOptions,\n): Promise<CaptureResult<unknown>> {\n  // If mocks provided, wrap the command with mockSanityCommand\n  const CommandToRun = options?.mocks\n    ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (mockSanityCommand(command as any, options.mocks) as CommandClass)\n    : command\n\n  const commandInstancePromise = () =>\n    CommandToRun.run(args || [], {\n      root: fileURLToPath(import.meta.url),\n      ...options?.config,\n    })\n\n  return captureOutput(commandInstancePromise, options?.capture)\n}\n"],"names":["fileURLToPath","captureOutput","mockSanityCommand","testCommand","command","args","options","CommandToRun","mocks","commandInstancePromise","run","root","url","config","capture"],"mappings":"AAAA,SAAQA,aAAa,QAAO,WAAU;AAItC,SAA6BC,aAAa,QAA2B,qBAAoB;AACzF,SAAQC,iBAAiB,QAAsC,yBAAwB;AAoBvF,OAAO,eAAeC,YACpBC,OAAqB,EACrBC,IAAe,EACfC,OAA4B;IAE5B,6DAA6D;IAC7D,MAAMC,eAAeD,SAASE,QAEzBN,kBAAkBE,SAAgBE,QAAQE,KAAK,IAChDJ;IAEJ,MAAMK,yBAAyB,IAC7BF,aAAaG,GAAG,CAACL,QAAQ,EAAE,EAAE;YAC3BM,MAAMX,cAAc,YAAYY,GAAG;YACnC,GAAGN,SAASO,MAAM;QACpB;IAEF,OAAOZ,cAAcQ,wBAAwBH,SAASQ;AACxD"}